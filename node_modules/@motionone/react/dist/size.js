import*as t from"react";import{createContext as e,useEffect as n,forwardRef as i,useContext as r,useMemo as a,useRef as s,createElement as o}from"react";function c(t,e){var n={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(t);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(t,i[r])&&(n[i[r]]=t[i[r]])}return n}function l(t,e){-1===t.indexOf(e)&&t.push(e)}const u=(t,e,n)=>Math.min(Math.max(n,t),e),h={duration:.3,delay:0,endDelay:0,repeat:0,easing:"ease"},p=t=>"number"==typeof t,f=t=>Array.isArray(t)&&!p(t[0]);const d=(t,e,n)=>-n*t+n*e+t,m=()=>{},y=t=>t,v=(t,e,n)=>e-t==0?1:(n-t)/(e-t);function g(t,e){const n=t[t.length-1];for(let i=1;i<=e;i++){const r=v(0,e,i);t.push(d(n,1,r))}}function w(t,e=function(t){const e=[0];return g(e,t-1),e}(t.length),n=y){const i=t.length,r=i-e.length;return r>0&&g(e,r),r=>{let a=0;for(;a<i-2&&!(r<e[a+1]);a++);let s=u(0,1,v(e[a],e[a+1],r));const o=function(t,e){return f(t)?t[((t,e,n)=>{const i=e-t;return((n-t)%i+i)%i+t})(0,t.length,e)]:t}(n,a);return s=o(s),d(t[a],t[a+1],s)}}const b=t=>Array.isArray(t)&&p(t[0]),E=t=>"object"==typeof t&&Boolean(t.createAnimation),O=t=>"function"==typeof t,S=t=>1e3*t,A=(t,e,n)=>(((1-3*n+3*e)*t+(3*n-6*e))*t+3*e)*t;function T(t,e,n,i){if(t===e&&n===i)return y;const r=e=>function(t,e,n,i,r){let a,s,o=0;do{s=e+(n-e)/2,a=A(s,i,r)-t,a>0?n=s:e=s}while(Math.abs(a)>1e-7&&++o<12);return s}(e,0,1,t,n);return t=>0===t||1===t?t:A(r(t),e,i)}const D={ease:T(.25,.1,.25,1),"ease-in":T(.42,0,1,1),"ease-in-out":T(.42,0,.58,1),"ease-out":T(0,0,.58,1)},M=/\((.*?)\)/;function x(t){if(O(t))return t;if(b(t))return T(...t);if(D[t])return D[t];if(t.startsWith("steps")){const e=M.exec(t);if(e){const t=e[1].split(",");return((t,e="end")=>n=>{const i=(n="end"===e?Math.min(n,.999):Math.max(n,.001))*t,r="end"===e?Math.floor(i):Math.ceil(i);return u(0,1,r/t)})(parseFloat(t[0]),t[1].trim())}}return y}class V{constructor(t,e=[0,1],{easing:n,duration:i=h.duration,delay:r=h.delay,endDelay:a=h.endDelay,repeat:s=h.repeat,offset:o,direction:c="normal"}={}){if(this.startTime=null,this.rate=1,this.t=0,this.cancelTimestamp=null,this.easing=y,this.duration=0,this.totalDuration=0,this.repeat=0,this.playState="idle",this.finished=new Promise(((t,e)=>{this.resolve=t,this.reject=e})),n=n||h.easing,E(n)){const t=n.createAnimation(e);n=t.easing,e=t.keyframes||e,i=t.duration||i}this.repeat=s,this.easing=f(n)?y:x(n),this.updateDuration(i);const l=w(e,o,f(n)?n.map(x):y);this.tick=e=>{var n;let i=0;i=void 0!==this.pauseTime?this.pauseTime:(e-this.startTime)*this.rate,this.t=i,i/=1e3,i=Math.max(i-r,0),"finished"===this.playState&&void 0===this.pauseTime&&(i=this.totalDuration);const s=i/this.duration;let o=Math.floor(s),u=s%1;!u&&s>=1&&(u=1),1===u&&o--;const h=o%2;("reverse"===c||"alternate"===c&&h||"alternate-reverse"===c&&!h)&&(u=1-u);const p=i>=this.totalDuration?1:Math.min(u,1),f=l(this.easing(p));t(f);void 0===this.pauseTime&&("finished"===this.playState||i>=this.totalDuration+a)?(this.playState="finished",null===(n=this.resolve)||void 0===n||n.call(this,f)):"idle"!==this.playState&&(this.frameRequestId=requestAnimationFrame(this.tick))},this.play()}play(){const t=performance.now();this.playState="running",void 0!==this.pauseTime?this.startTime=t-this.pauseTime:this.startTime||(this.startTime=t),this.cancelTimestamp=this.startTime,this.pauseTime=void 0,this.frameRequestId=requestAnimationFrame(this.tick)}pause(){this.playState="paused",this.pauseTime=this.t}finish(){this.playState="finished",this.tick(0)}stop(){var t;this.playState="idle",void 0!==this.frameRequestId&&cancelAnimationFrame(this.frameRequestId),null===(t=this.reject)||void 0===t||t.call(this,!1)}cancel(){this.stop(),this.tick(this.cancelTimestamp)}reverse(){this.rate*=-1}commitStyles(){}updateDuration(t){this.duration=t,this.totalDuration=t*(this.repeat+1)}get currentTime(){return this.t}set currentTime(t){void 0!==this.pauseTime||0===this.rate?this.pauseTime=t:this.startTime=performance.now()-t/this.rate}get playbackRate(){return this.rate}set playbackRate(t){this.rate=t}}var j=function(){};"production"!==process.env.NODE_ENV&&(j=function(t,e){if(!t)throw new Error(e)});class P{setAnimation(t){this.animation=t,null==t||t.finished.then((()=>this.clearAnimation())).catch((()=>{}))}clearAnimation(){this.animation=this.generator=void 0}}const k=new WeakMap;function L(t){return k.has(t)||k.set(t,{transforms:[],values:new Map}),k.get(t)}const C=["","X","Y","Z"],R={x:"translateX",y:"translateY",z:"translateZ"},I={syntax:"<angle>",initialValue:"0deg",toDefaultUnit:t=>t+"deg"},q={translate:{syntax:"<length-percentage>",initialValue:"0px",toDefaultUnit:t=>t+"px"},rotate:I,scale:{syntax:"<number>",initialValue:1,toDefaultUnit:y},skew:I},B=new Map,U=t=>`--motion-${t}`,$=["x","y","z"];["translate","scale","rotate","skew"].forEach((t=>{C.forEach((e=>{$.push(t+e),B.set(U(t+e),q[t])}))}));const F=(t,e)=>$.indexOf(t)-$.indexOf(e),H=new Set($),W=t=>H.has(t),_=t=>t.sort(F).reduce(z,"").trim(),z=(t,e)=>`${t} ${e}(var(${U(e)}))`,N=t=>t.startsWith("--"),K=new Set;const X=(t,e)=>document.createElement("div").animate(t,e),Y={cssRegisterProperty:()=>"undefined"!=typeof CSS&&Object.hasOwnProperty.call(CSS,"registerProperty"),waapi:()=>Object.hasOwnProperty.call(Element.prototype,"animate"),partialKeyframes:()=>{try{X({opacity:[1]})}catch(t){return!1}return!0},finished:()=>Boolean(X({opacity:[0,1]},{duration:.001}).finished),linearEasing:()=>{try{X({opacity:0},{easing:"linear(0, 1)"})}catch(t){return!1}return!0}},Z={},G={};for(const t in Y)G[t]=()=>(void 0===Z[t]&&(Z[t]=Y[t]()),Z[t]);const J=(t,e)=>O(t)?G.linearEasing()?`linear(${((t,e)=>{let n="";const i=Math.round(e/.015);for(let e=0;e<i;e++)n+=t(v(0,i-1,e))+", ";return n.substring(0,n.length-2)})(t,e)})`:h.easing:b(t)?Q(t):t,Q=([t,e,n,i])=>`cubic-bezier(${t}, ${e}, ${n}, ${i})`;function tt(t){return R[t]&&(t=R[t]),W(t)?U(t):t}const et=(t,e)=>{e=tt(e);let n=N(e)?t.style.getPropertyValue(e):getComputedStyle(t)[e];if(!n&&0!==n){const t=B.get(e);t&&(n=t.initialValue)}return n},nt=(t,e,n)=>{e=tt(e),N(e)?t.style.setProperty(e,n):t.style[e]=n};function it(t,e,n,i={},r){const a=window.__MOTION_DEV_TOOLS_RECORD,s=!1!==i.record&&a;let o,{duration:c=h.duration,delay:u=h.delay,endDelay:d=h.endDelay,repeat:v=h.repeat,easing:g=h.easing,persist:w=!1,direction:b,offset:A,allowWebkitAcceleration:T=!1}=i;const D=L(t),M=W(e);let x=G.waapi();M&&((t,e)=>{R[e]&&(e=R[e]);const{transforms:n}=L(t);l(n,e),t.style.transform=_(n)})(t,e);const V=tt(e),j=function(t,e){return t.has(e)||t.set(e,new P),t.get(e)}(D.values,V),k=B.get(V);return function(t,e=!0){if(t&&"finished"!==t.playState)try{t.stop?t.stop():(e&&t.commitStyles(),t.cancel())}catch(t){}}(j.animation,!(E(g)&&j.generator)&&!1!==i.record),()=>{const l=()=>{var e,n;return null!==(n=null!==(e=et(t,V))&&void 0!==e?e:null==k?void 0:k.initialValue)&&void 0!==n?n:0};let h=function(t,e){for(let n=0;n<t.length;n++)null===t[n]&&(t[n]=n?t[n-1]:e());return t}((t=>Array.isArray(t)?t:[t])(n),l);const D=function(t,e){var n;let i=(null==e?void 0:e.toDefaultUnit)||y;const r=t[t.length-1];if("string"==typeof r){const t=(null===(n=r.match(/(-?[\d.]+)([a-z%]*)/))||void 0===n?void 0:n[2])||"";t&&(i=e=>e+t)}return i}(h,k);if(E(g)){const t=g.createAnimation(h,"opacity"!==e,l,V,j);g=t.easing,h=t.keyframes||h,c=t.duration||c}if(N(V)&&(G.cssRegisterProperty()?function(t){if(!K.has(t)){K.add(t);try{const{syntax:e,initialValue:n}=B.has(t)?B.get(t):{};CSS.registerProperty({name:t,inherits:!1,syntax:e,initialValue:n})}catch(t){}}}(V):x=!1),M&&!G.linearEasing()&&(O(g)||f(g)&&g.some(O))&&(x=!1),x){k&&(h=h.map((t=>p(t)?k.toDefaultUnit(t):t))),1!==h.length||G.partialKeyframes()&&!s||h.unshift(l());const e={delay:S(u),duration:S(c),endDelay:S(d),easing:f(g)?void 0:J(g,c),direction:b,iterations:v+1,fill:"both"};o=t.animate({[V]:h,offset:A,easing:f(g)?g.map((t=>J(t,c))):void 0},e),o.finished||(o.finished=new Promise(((t,e)=>{o.onfinish=t,o.oncancel=e})));const n=h[h.length-1];o.finished.then((()=>{w||(nt(t,V,n),o.cancel())})).catch(m),T||(o.playbackRate=1.000001)}else if(r&&M)h=h.map((t=>"string"==typeof t?parseFloat(t):t)),1===h.length&&h.unshift(parseFloat(l())),o=new r((e=>{nt(t,V,D?D(e):e)}),h,Object.assign(Object.assign({},i),{duration:c,easing:g}));else{const e=h[h.length-1];nt(t,V,k&&p(e)?k.toDefaultUnit(e):e)}return s&&a(t,e,h,{duration:c,delay:u,easing:g,repeat:v,offset:A},"motion-one"),j.setAnimation(o),o}}const rt=(t,e)=>t[e]?Object.assign(Object.assign({},t),t[e]):Object.assign({},t);const at={any:0,all:1};function st(t,e,{root:n,margin:i,amount:r="any"}={}){if("undefined"==typeof IntersectionObserver)return()=>{};const a=function(t,e){var n;return"string"==typeof t?e?(null!==(n=e[t])&&void 0!==n||(e[t]=document.querySelectorAll(t)),t=e[t]):t=document.querySelectorAll(t):t instanceof Element&&(t=[t]),Array.from(t||[])}(t),s=new WeakMap,o=new IntersectionObserver((t=>{t.forEach((t=>{const n=s.get(t.target);if(t.isIntersecting!==Boolean(n))if(t.isIntersecting){const n=e(t);O(n)?s.set(t.target,n):o.unobserve(t.target)}else n&&(n(t),s.delete(t.target))}))}),{root:n,rootMargin:i,threshold:"number"==typeof r?r:at[r]});return a.forEach((t=>o.observe(t))),()=>o.disconnect()}function ot(t,e){return function(t){return"object"==typeof t}(t)?t:t&&e?e[t]:void 0}let ct;function lt(){if(!ct)return;const t=ct.sort(ht).map(pt);t.forEach(ft),t.forEach(ft),ct=void 0}function ut(t){ct?l(ct,t):(ct=[t],requestAnimationFrame(lt))}const ht=(t,e)=>t.getDepth()-e.getDepth(),pt=t=>t.animateUpdates(),ft=t=>t.next(),dt=(t,e)=>new CustomEvent(t,{detail:{target:e}});function mt(t,e,n){t.dispatchEvent(new CustomEvent(e,{detail:{originalEvent:n}}))}function yt(t,e,n){t.dispatchEvent(new CustomEvent(e,{detail:{originalEntry:n}}))}const vt=(t,e,n)=>i=>{i.pointerType&&"mouse"!==i.pointerType||(n(),mt(t,e,i))},gt={inView:{isActive:t=>Boolean(t.inView),subscribe:(t,{enable:e,disable:n},{inViewOptions:i={}})=>{const{once:r}=i,a=c(i,["once"]);return st(t,(i=>{if(e(),yt(t,"viewenter",i),!r)return e=>{n(),yt(t,"viewleave",e)}}),a)}},hover:{isActive:t=>Boolean(t.hover),subscribe:(t,{enable:e,disable:n})=>{const i=vt(t,"hoverstart",e),r=vt(t,"hoverend",n);return t.addEventListener("pointerenter",i),t.addEventListener("pointerleave",r),()=>{t.removeEventListener("pointerenter",i),t.removeEventListener("pointerleave",r)}}},press:{isActive:t=>Boolean(t.press),subscribe:(t,{enable:e,disable:n})=>{const i=e=>{n(),mt(t,"pressend",e),window.removeEventListener("pointerup",i)},r=n=>{e(),mt(t,"pressstart",n),window.addEventListener("pointerup",i)};return t.addEventListener("pointerdown",r),()=>{t.removeEventListener("pointerdown",r),window.removeEventListener("pointerup",i)}}}},wt=["initial","animate",...Object.keys(gt),"exit"],bt=new WeakMap;function Et(t={},e){let n,i=e?e.getDepth()+1:0;const r={initial:!0,animate:!0},a={},s={};for(const n of wt)s[n]="string"==typeof t[n]?t[n]:null==e?void 0:e.getContext()[n];const o=!1===t.initial?"animate":"initial";let l=c(ot(t[o]||s[o],t.variants)||{},["transition"]);const u=Object.assign({},l);const h=(t,e)=>()=>{r[t]=e,ut(f)},p=()=>{for(const e in gt){const i=gt[e].isActive(t),r=a[e];i&&!r?a[e]=gt[e].subscribe(n,{enable:h(e,!0),disable:h(e,!1)},t):!i&&r&&(r(),delete a[e])}},f={update:e=>{n&&(t=e,p(),ut(f))},setActive:(t,e)=>{n&&(r[t]=e,ut(f))},animateUpdates:function*(){var e,i;const a=l;l={};const s={};for(const n of wt){if(!r[n])continue;const a=ot(t[n]);if(a)for(const n in a)"transition"!==n&&(l[n]=a[n],s[n]=rt(null!==(i=null!==(e=a.transition)&&void 0!==e?e:t.transition)&&void 0!==i?i:{},n))}const o=new Set([...Object.keys(l),...Object.keys(a)]),c=[];o.forEach((t=>{var e,i,r;void 0===l[t]&&(l[t]=u[t]),i=a[t],r=l[t],typeof i==typeof r&&(Array.isArray(i)&&Array.isArray(r)?function(t,e){const n=e.length;if(n!==t.length)return!1;for(let i=0;i<n;i++)if(e[i]!==t[i])return!1;return!0}(i,r):i===r)||(null!==(e=u[t])&&void 0!==e||(u[t]=et(n,t)),c.push(it(n,t,l[t],s[t],V)))})),yield;const h=c.map((t=>t())).filter(Boolean);if(!h.length)return;const p=l;n.dispatchEvent(dt("motionstart",p)),Promise.all(h.map((t=>t.finished))).then((()=>{n.dispatchEvent(dt("motioncomplete",p))})).catch(m)},getDepth:()=>i,getTarget:()=>l,getOptions:()=>t,getContext:()=>s,mount:t=>(j(Boolean(t),"Animation state must be mounted with valid Element"),n=t,bt.set(n,f),p(),()=>{bt.delete(n),function(t){ct&&function(t,e){const n=t.indexOf(e);n>-1&&t.splice(n,1)}(ct,t)}(f);for(const t in a)a[t]()}),isMounted:()=>Boolean(n)};return f}const Ot=e(void 0);function St(e){return i((function(i,l){var{initial:u,animate:h,press:f,hover:d,inView:m,inViewOptions:y,variants:v,style:g,transition:w,onMotionStart:b,onMotionComplete:E,onHoverStart:O,onHoverEnd:S,onPressStart:A,onPressEnd:T,onViewEnter:D,onViewLeave:M}=i,x=c(i,["initial","animate","press","hover","inView","inViewOptions","variants","style","transition","onMotionStart","onMotionComplete","onHoverStart","onHoverEnd","onPressStart","onPressEnd","onViewEnter","onViewLeave"]);const V={initial:u,animate:h,press:f,hover:d,inView:m,inViewOptions:y,variants:v,transition:w},j=Et(V,r(Ot)),P=a((()=>function(t){const e={},n=[];for(let i in t){const r=t[i];W(i)&&(R[i]&&(i=R[i]),n.push(i),i=U(i));let a=Array.isArray(r)?r[0]:r;const s=B.get(i);s&&(a=p(r)?s.toDefaultUnit(r):r),e[i]=a}return n.length&&(e.transform=_(n)),e}(j.getTarget())),[]),k=l||s(null);n((()=>j.mount(k.current)),[]),n((()=>j.update(V))),function(t,e){n((()=>{const n=Object.keys(e).map((n=>{return i=t.current,r=n.replace("on","").toLowerCase(),a=e[n],i.addEventListener(r,a,s),()=>i.removeEventListener(r,a,s);var i,r,a,s}));return()=>{n.forEach((t=>t()))}}))}(k,{onMotionStart:b,onMotionComplete:E,onHoverStart:O,onHoverEnd:S,onPressStart:A,onPressEnd:T,onViewEnter:D,onViewLeave:M});const L=o(e,Object.assign(Object.assign({},x),{ref:k,style:Object.assign(Object.assign({},g),P)}));return t.createElement(Ot.Provider,{value:j},L)}))}const At=new Map,Tt=new Proxy({},{get:(t,e)=>(!At.has(e)&&At.set(e,St(e)),At.get(e))});export{Tt as motion};
